{% extends "expert_page/layouts/expert_base.html" %}
{% block title %}គ្រប់គ្រងរោគសញ្ញា{% endblock %}

{% block content %}
<style>
    /* Custom CSS ឱ្យដូចរូបភាព */
    
    /* 1. ប្រអប់បញ្ចូលទិន្នន័យ (Top Card) */
    .input-card {
        background: white;
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        border: none;
        margin-bottom: 25px;
    }
    .disease-title {
        color: #2f3e2e; /* ពណ៌បៃតងចាស់ */
        font-weight: bold;
        font-size: 1.2rem;
        margin-bottom: 20px;
    }
    
    /* Input Field & Button Group */
    .input-group-custom {
        background: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 50px;
        padding: 5px;
        display: flex;
        align-items: center;
        transition: all 0.3s;
    }
    .input-group-custom:focus-within {
        border-color: #50664e;
        background: white;
        box-shadow: 0 0 0 3px rgba(80, 102, 78, 0.1);
    }
    .form-input {
        border: none;
        background: transparent;
        flex-grow: 1;
        padding: 10px 20px;
        outline: none;
        font-size: 1rem;
        color: #495057;
    }
    .btn-add {
        background-color: #4a6741; /* ពណ៌បៃតង */
        color: white;
        border: none;
        border-radius: 50px;
        padding: 10px 30px;
        font-weight: bold;
        transition: 0.2s;
        white-space: nowrap;
    }
    .btn-add:hover {
        background-color: #3b5234;
        color: white;
    }

    /* 2. បញ្ជីរោគសញ្ញា (List Card) */
    .list-card {
        background: white;
        border-radius: 15px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        border: none;
        overflow: hidden;
    }
    .list-header {
        padding: 20px 25px;
        font-weight: bold;
        color: #212529;
        border-bottom: 1px solid #f0f0f0;
    }
    
    .symptom-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 18px 25px;
        border-bottom: 1px solid #f8f9fa;
        transition: background 0.2s;
    }
    .symptom-item:hover {
        background-color: #fafafa;
    }
    .symptom-item:last-child {
        border-bottom: none;
    }
    
    /* Icon Check */
    .icon-check {
        color: #4a6741; /* ពណ៌បៃតង */
        font-size: 1.2rem;
        margin-right: 15px;
    }

    /* Action Buttons (Edit/Delete) */
    .btn-icon {
        width: 38px;
        height: 38px;
        border-radius: 50%;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border: 1px solid #eee;
        transition: 0.2s;
        background: white;
        margin-left: 8px;
        text-decoration: none;
    }
    
    .btn-edit {
        color: #f59e0b; /* ពណ៌លឿង */
        border-color: #fef3c7;
    }
    .btn-edit:hover {
        background-color: #fffbeb;
        border-color: #f59e0b;
    }
    
    .btn-delete {
        color: #dc3545; /* ពណ៌ក្រហម */
        border-color: #f8d7da;
    }
    .btn-delete:hover {
        background-color: #fef2f2;
        border-color: #dc3545;
    }

    /* Back Link */
    .back-link {
        display: block;
        text-align: center;
        margin-top: 20px;
        color: #6c757d;
        text-decoration: none;
        font-size: 0.9rem;
    }
    .back-link:hover {
        color: #4a6741;
    }
</style>

<div class="container p-0" style="max-width: 900px;">
    
    <div class="input-card">
        <div class="disease-title">
            គ្រប់គ្រងរោគសញ្ញា៖ {{ disease.disease_name }}
            <span class="text-muted small ms-2 fw-normal">({{ disease.disease_type }})</span>
        </div>
        
        <form method="POST" action="{{ url_for('expert.manage_symptoms', disease_id=disease.id) }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            
            <div class="input-group-custom">
                <input type="text" name="description" class="form-input" placeholder="សរសេររោគសញ្ញាថ្មីនៅទីនេះ..." required autocomplete="off">
                <button type="submit" class="btn-add">បន្ថែម</button>
            </div>
        </form>
    </div>

    <div class="list-card">
        <div class="list-header">
            បញ្ជីរោគសញ្ញាបច្ចុប្បន្ន
        </div>

        <div class="symptom-list">
            {% if symptoms %}
                {% for symptom in symptoms %}
                <div class="symptom-item">
                    <div class="d-flex align-items-center">
                        <i class="bi bi-check-circle-fill icon-check"></i>
                        <span class="text-dark">{{ symptom.description }}</span>
                    </div>

                    <div class="d-flex">
                        <a href="#" class="btn-icon btn-edit" title="កែប្រែ">
                            <i class="bi bi-pencil-square"></i>
                        </a>

                        <form action="{{ url_for('expert.delete_symptom', symptom_id=symptom.id) }}" method="POST" class="d-inline">
                            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                            <button type="submit" class="btn-icon btn-delete" onclick="return confirm('តើអ្នកពិតជាចង់លុបរោគសញ្ញានេះមែនទេ?')" title="លុប">
                                <i class="bi bi-trash"></i>
                            </button>
                        </form>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div class="text-center py-5">
                    <p class="text-muted mb-0">មិនទាន់មានរោគសញ្ញានៅឡើយ។</p>
                    <small class="text-secondary">សូមវាយបញ្ចូលក្នុងប្រអប់ខាងលើ។</small>
                </div>
            {% endif %}
        </div>
    </div>

    <a href="{{ url_for('expert.disease_list') }}" class="back-link">
        ← ត្រឡប់ទៅបញ្ជីជំងឺ (Disease List)
    </a>

</div>
{% endblock %}